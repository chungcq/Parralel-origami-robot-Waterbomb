function M=matrixM(q)
% q=[pi/3; 1.7722];
global m1 m2 m3 m4 m5 m6 mt J1 J2 J3 JB g a b d I1x I1y I1z I2x I2y I2z I2yz I3x I3y I3z
q0=q(1); q1=q(2);
m11=18*I1x + 4*I2x + 4*I3x + 10*I1y + 2*I2y + 18*I3y + 8*I2yz + 4*I1z + 26*I2z + 10*I3z + 12*I1x*cos(q1) - 8*I1y*cos(q1) + 4*I2y*cos(q1) + 8*I2yz*cos(q1) - 12*I1z*cos(q1) - 12*I2z*cos(q1) - 8*I3z*cos(q1) + a^2*m1 + (11*a^2*m2)/9 + (83*a^2*m3)/9 + a^2*m4 + (83*a^2*m5)/9 + (11*a^2*m6)/9 + 36*b^2*m1 + 18*b^2*m2 + 10*b^2*m3 + 36*b^2*m4 + 10*b^2*m5 + 18*b^2*m6 + 16*b^2*mt - 8*I1x*cos(q0)^2 - 16*I1x*cos(q1)^2 - 4*I2x*cos(q0)^2 - 2*I1x*cos(q0)^4 - 12*I1x*cos(q1)^3 - 4*I2x*cos(q1)^2 - 4*I3x*cos(q0)^2 - 2*I1x*cos(q1)^4 + 4*I2x*cos(q0)^4 - 4*I3x*cos(q1)^2 + 4*I3x*cos(q0)^4 + 12*I1y*cos(q0)^2 + 2*I1y*cos(q1)^2 + 4*I2y*cos(q0)^2 - 2*I1y*cos(q0)^4 + 2*I2y*cos(q1)^2 - 8*I3y*cos(q0)^2 - 4*I2y*cos(q0)^4 + 2*I3y*cos(q1)^2 - 2*I3y*cos(q0)^4 - 20*I2yz*cos(q0)^2 - 4*I1z*cos(q0)^2 + 14*I1z*cos(q1)^2 + 4*I1z*cos(q0)^4 + 12*I1z*cos(q1)^3 + 2*I2z*cos(q1)^2 + 12*I3z*cos(q0)^2 + 2*I1z*cos(q1)^4 + 2*I3z*cos(q1)^2 - 2*I3z*cos(q0)^4 - 12*I1x*cos(q0)^2*cos(q1)^2 + 56*I1x*cos(q0)^2*cos(q1)^3 + 12*I2x*cos(q0)^2*cos(q1)^2 + 28*I1x*cos(q0)^2*cos(q1)^4 + 28*I1x*cos(q0)^4*cos(q1)^2 + 12*I3x*cos(q0)^2*cos(q1)^2 - 28*I1x*cos(q0)^4*cos(q1)^3 - 12*I2x*cos(q0)^4*cos(q1)^2 - 34*I1x*cos(q0)^4*cos(q1)^4 - 12*I3x*cos(q0)^4*cos(q1)^2 - 8*I1y*cos(q0)^2*cos(q1)^2 - 12*I2y*cos(q0)^2*cos(q1)^2 + 6*I1y*cos(q0)^4*cos(q1)^2 - 4*I3y*cos(q0)^2*cos(q1)^2 + 12*I2y*cos(q0)^4*cos(q1)^2 + 6*I3y*cos(q0)^4*cos(q1)^2 + 4*I2yz*cos(q0)^2*cos(q1)^2 + 20*I1z*cos(q0)^2*cos(q1)^2 - 56*I1z*cos(q0)^2*cos(q1)^3 - 28*I1z*cos(q0)^2*cos(q1)^4 - 34*I1z*cos(q0)^4*cos(q1)^2 - 8*I3z*cos(q0)^2*cos(q1)^2 + 28*I1z*cos(q0)^4*cos(q1)^3 + 34*I1z*cos(q0)^4*cos(q1)^4 + 6*I3z*cos(q0)^4*cos(q1)^2 - (2*a^2*m2*cos(q1))/3 - (70*a^2*m3*cos(q1))/9 - (70*a^2*m5*cos(q1))/9 - (2*a^2*m6*cos(q1))/3 - 16*b^2*m2*cos(q1) + 8*b^2*m3*cos(q1) + 8*b^2*m5*cos(q1) - 16*b^2*m6*cos(q1) - 48*I1x*cos(q0)^2*cos(q1) + 8*I2x*cos(q0)^2*cos(q1) + 20*I1x*cos(q0)^4*cos(q1) + 8*I3x*cos(q0)^2*cos(q1) - 8*I2x*cos(q0)^4*cos(q1) - 8*I3x*cos(q0)^4*cos(q1) + 4*I1y*cos(q0)^2*cos(q1) - 8*I2y*cos(q0)^2*cos(q1) + 4*I1y*cos(q0)^4*cos(q1) - 12*I3y*cos(q0)^2*cos(q1) + 8*I2y*cos(q0)^4*cos(q1) + 4*I3y*cos(q0)^4*cos(q1) - 16*I2yz*cos(q0)^2*cos(q1) + 44*I1z*cos(q0)^2*cos(q1) - 24*I1z*cos(q0)^4*cos(q1) + 4*I3z*cos(q0)^2*cos(q1) + 4*I3z*cos(q0)^4*cos(q1) - (a^2*m2*cos(q1)^2)/9 - (68*a^2*m3*cos(q0)^2)/9 - a^2*m3*cos(q1)^2 + 8*a^2*m4*cos(q0)^2 + (4*a^2*m3*cos(q0)^4)/9 - (68*a^2*m5*cos(q0)^2)/9 - a^2*m5*cos(q1)^2 + (4*a^2*m5*cos(q0)^4)/9 - (a^2*m6*cos(q1)^2)/9 + 4*a^2*mt*cos(q0)^2 + 2*b^2*m2*cos(q1)^2 + 84*b^2*m3*cos(q0)^2 + 2*b^2*m3*cos(q1)^2 - 4*b^2*m3*cos(q0)^4 + 84*b^2*m5*cos(q0)^2 + 2*b^2*m5*cos(q1)^2 - 4*b^2*m5*cos(q0)^4 + 2*b^2*m6*cos(q1)^2 - 16*b^2*mt*cos(q0)^2 + (32*a^2*m3*cos(q0)^2*cos(q1))/3 - (8*a^2*m3*cos(q0)^4*cos(q1))/9 + (32*a^2*m5*cos(q0)^2*cos(q1))/3 - (8*a^2*m5*cos(q0)^4*cos(q1))/9 - 104*b^2*m3*cos(q0)^2*cos(q1) + 8*b^2*m3*cos(q0)^4*cos(q1) - 104*b^2*m5*cos(q0)^2*cos(q1) + 8*b^2*m5*cos(q0)^4*cos(q1) + (74*a*b*m3*sin(2*q0))/3 - 24*a*b*m4*sin(2*q0) + (74*a*b*m5*sin(2*q0))/3 - 8*a*b*mt*sin(2*q0) + (20*a^2*m3*cos(q0)^2*cos(q1)^2)/9 - (4*a^2*m3*cos(q0)^4*cos(q1)^2)/3 + (20*a^2*m5*cos(q0)^2*cos(q1)^2)/9 - (4*a^2*m5*cos(q0)^4*cos(q1)^2)/3 + 4*b^2*m3*cos(q0)^2*cos(q1)^2 + 12*b^2*m3*cos(q0)^4*cos(q1)^2 + 4*b^2*m5*cos(q0)^2*cos(q1)^2 + 12*b^2*m5*cos(q0)^4*cos(q1)^2 + 4*2^(1/2)*I1x*cos(q0)^3*sin(q0)*sin(q1) - 8*2^(1/2)*I2x*cos(q0)^3*sin(q0)*sin(q1) - 8*2^(1/2)*I3x*cos(q0)^3*sin(q0)*sin(q1) + 4*2^(1/2)*I1y*cos(q0)^3*sin(q0)*sin(q1) + 8*2^(1/2)*I2y*cos(q0)^3*sin(q0)*sin(q1) + 4*2^(1/2)*I3y*cos(q0)^3*sin(q0)*sin(q1) - 8*2^(1/2)*I1z*cos(q0)^3*sin(q0)*sin(q1) + 4*2^(1/2)*I3z*cos(q0)^3*sin(q0)*sin(q1) + (2^(1/2)*a*b*m2*sin(2*q1))/3 + 2^(1/2)*a*b*m3*sin(2*q1) + 2^(1/2)*a*b*m5*sin(2*q1) + (2^(1/2)*a*b*m6*sin(2*q1))/3 - 12*2^(1/2)*I1x*cos(q0)*sin(q0)*sin(q1) + 4*2^(1/2)*I2x*cos(q0)*sin(q0)*sin(q1) + 4*2^(1/2)*I3x*cos(q0)*sin(q0)*sin(q1) + 8*2^(1/2)*I1y*cos(q0)*sin(q0)*sin(q1) - 4*2^(1/2)*I2y*cos(q0)*sin(q0)*sin(q1) - 12*2^(1/2)*I3y*cos(q0)*sin(q0)*sin(q1) - 20*2^(1/2)*I2yz*cos(q0)*sin(q0)*sin(q1) + 4*2^(1/2)*I1z*cos(q0)*sin(q0)*sin(q1) + 8*2^(1/2)*I3z*cos(q0)*sin(q0)*sin(q1) - (8*a*b*m3*cos(q0)^3*sin(q0))/3 - (8*a*b*m5*cos(q0)^3*sin(q0))/3 - (2*2^(1/2)*a*b*m2*sin(q1))/3 - (38*2^(1/2)*a*b*m3*sin(q1))/3 - (38*2^(1/2)*a*b*m5*sin(q1))/3 - (2*2^(1/2)*a*b*m6*sin(q1))/3 + (88*2^(1/2)*a*b*m3*cos(q0)^2*sin(q1))/3 - (16*2^(1/2)*a*b*m3*cos(q0)^4*sin(q1))/3 + (88*2^(1/2)*a*b*m5*cos(q0)^2*sin(q1))/3 - (16*2^(1/2)*a*b*m5*cos(q0)^4*sin(q1))/3 - 64*a*b*m3*cos(q0)*cos(q1)*sin(q0) - 64*a*b*m5*cos(q0)*cos(q1)*sin(q0) - 20*2^(1/2)*I1x*cos(q0)^3*cos(q1)^2*sin(q0)*sin(q1) - 24*2^(1/2)*I1x*cos(q0)^3*cos(q1)^3*sin(q0)*sin(q1) + 20*2^(1/2)*I1z*cos(q0)^3*cos(q1)^2*sin(q0)*sin(q1) + 24*2^(1/2)*I1z*cos(q0)^3*cos(q1)^3*sin(q0)*sin(q1) + 8*2^(1/2)*I1x*cos(q0)*cos(q1)*sin(q0)*sin(q1) + 4*2^(1/2)*I2x*cos(q0)*cos(q1)*sin(q0)*sin(q1) + 4*2^(1/2)*I3x*cos(q0)*cos(q1)*sin(q0)*sin(q1) - 4*2^(1/2)*I1y*cos(q0)*cos(q1)*sin(q0)*sin(q1) - 4*2^(1/2)*I2y*cos(q0)*cos(q1)*sin(q0)*sin(q1) + 4*2^(1/2)*I2yz*cos(q0)*cos(q1)*sin(q0)*sin(q1) - 4*2^(1/2)*I1z*cos(q0)*cos(q1)*sin(q0)*sin(q1) - 4*2^(1/2)*I3z*cos(q0)*cos(q1)*sin(q0)*sin(q1) - (4*a*b*m3*cos(q0)*cos(q1)^2*sin(q0))/3 + (16*a*b*m3*cos(q0)^3*cos(q1)*sin(q0))/3 - (4*a*b*m5*cos(q0)*cos(q1)^2*sin(q0))/3 + (16*a*b*m5*cos(q0)^3*cos(q1)*sin(q0))/3 + 4*2^(1/2)*a^2*m3*cos(q0)*sin(q0)*sin(q1) + 4*2^(1/2)*a^2*m5*cos(q0)*sin(q0)*sin(q1) - 44*2^(1/2)*b^2*m3*cos(q0)*sin(q0)*sin(q1) - 44*2^(1/2)*b^2*m5*cos(q0)*sin(q0)*sin(q1) + 28*2^(1/2)*I1x*cos(q0)*cos(q1)^2*sin(q0)*sin(q1) + 8*2^(1/2)*I1x*cos(q0)*cos(q1)^3*sin(q0)*sin(q1) + 8*2^(1/2)*I1x*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) - 8*2^(1/2)*I2x*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) - 8*2^(1/2)*I3x*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 4*2^(1/2)*I1y*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 8*2^(1/2)*I2y*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 4*2^(1/2)*I3y*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) - 28*2^(1/2)*I1z*cos(q0)*cos(q1)^2*sin(q0)*sin(q1) - 8*2^(1/2)*I1z*cos(q0)*cos(q1)^3*sin(q0)*sin(q1) - 12*2^(1/2)*I1z*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 4*2^(1/2)*I3z*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 8*a*b*m3*cos(q0)^3*cos(q1)^2*sin(q0) + 8*a*b*m5*cos(q0)^3*cos(q1)^2*sin(q0) - (8*2^(1/2)*a^2*m3*cos(q0)^3*sin(q0)*sin(q1))/9 - (8*2^(1/2)*a^2*m5*cos(q0)^3*sin(q0)*sin(q1))/9 + 8*2^(1/2)*b^2*m3*cos(q0)^3*sin(q0)*sin(q1) + 8*2^(1/2)*b^2*m5*cos(q0)^3*sin(q0)*sin(q1) + (4*2^(1/2)*a^2*m3*cos(q0)*cos(q1)*sin(q0)*sin(q1))/3 + (4*2^(1/2)*a^2*m5*cos(q0)*cos(q1)*sin(q0)*sin(q1))/3 + 4*2^(1/2)*b^2*m3*cos(q0)*cos(q1)*sin(q0)*sin(q1) + 4*2^(1/2)*b^2*m5*cos(q0)*cos(q1)*sin(q0)*sin(q1) - (8*2^(1/2)*a^2*m3*cos(q0)^3*cos(q1)*sin(q0)*sin(q1))/9 - (8*2^(1/2)*a^2*m5*cos(q0)^3*cos(q1)*sin(q0)*sin(q1))/9 + 8*2^(1/2)*b^2*m3*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 8*2^(1/2)*b^2*m5*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + (16*2^(1/2)*a*b*m3*cos(q0)^2*cos(q1)*sin(q1))/3 - (16*2^(1/2)*a*b*m3*cos(q0)^4*cos(q1)*sin(q1))/3 + (16*2^(1/2)*a*b*m5*cos(q0)^2*cos(q1)*sin(q1))/3 - (16*2^(1/2)*a*b*m5*cos(q0)^4*cos(q1)*sin(q1))/3;
m12=8*2^(1/2)*I1x*cos(q0)^2 - 4*2^(1/2)*I1y - 2*2^(1/2)*I2y - 6*2^(1/2)*I3y - 4*2^(1/2)*I2yz - 6*2^(1/2)*I2z - 2*2^(1/2)*I3z - 6*2^(1/2)*I1x + 6*2^(1/2)*I1x*cos(q1)^2 - 4*2^(1/2)*I2x*cos(q0)^2 - 2*2^(1/2)*I1x*cos(q0)^4 + 2*2^(1/2)*I1x*cos(q1)^3 - 4*2^(1/2)*I3x*cos(q0)^2 + 4*2^(1/2)*I2x*cos(q0)^4 + 4*2^(1/2)*I3x*cos(q0)^4 - 6*2^(1/2)*I1y*cos(q0)^2 + 4*2^(1/2)*I2y*cos(q0)^2 - 2*2^(1/2)*I1y*cos(q0)^4 + 8*2^(1/2)*I3y*cos(q0)^2 - 4*2^(1/2)*I2y*cos(q0)^4 - 2*2^(1/2)*I3y*cos(q0)^4 + 12*2^(1/2)*I2yz*cos(q0)^2 - 4*2^(1/2)*I1z*cos(q0)^2 - 6*2^(1/2)*I1z*cos(q1)^2 + 4*2^(1/2)*I1z*cos(q0)^4 - 2*2^(1/2)*I1z*cos(q1)^3 - 4*2^(1/2)*I3z*cos(q0)^2 - 2*2^(1/2)*I3z*cos(q0)^4 - 2*2^(1/2)*I1x*cos(q1) + 2*2^(1/2)*I1y*cos(q1) - 2*2^(1/2)*I2y*cos(q1) + 2*2^(1/2)*I1z*cos(q1) + 2*2^(1/2)*I2z*cos(q1) - (2^(1/2)*a^2*m2)/9 - (7*2^(1/2)*a^2*m3)/3 - (7*2^(1/2)*a^2*m5)/3 - (2^(1/2)*a^2*m6)/9 - 2*2^(1/2)*b^2*m2 + 2*2^(1/2)*b^2*m3 + 2*2^(1/2)*b^2*m5 - 2*2^(1/2)*b^2*m6 + 12*2^(1/2)*I1x*cos(q0)^2*cos(q1) - 4*2^(1/2)*I2x*cos(q0)^2*cos(q1) - 10*2^(1/2)*I1x*cos(q0)^4*cos(q1) - 4*2^(1/2)*I3x*cos(q0)^2*cos(q1) + 4*2^(1/2)*I2x*cos(q0)^4*cos(q1) + 4*2^(1/2)*I3x*cos(q0)^4*cos(q1) + 4*2^(1/2)*I2y*cos(q0)^2*cos(q1) - 2*2^(1/2)*I1y*cos(q0)^4*cos(q1) + 2*2^(1/2)*I3y*cos(q0)^2*cos(q1) - 4*2^(1/2)*I2y*cos(q0)^4*cos(q1) - 2*2^(1/2)*I3y*cos(q0)^4*cos(q1) - 14*2^(1/2)*I1z*cos(q0)^2*cos(q1) + 12*2^(1/2)*I1z*cos(q0)^4*cos(q1) + 2*2^(1/2)*I3z*cos(q0)^2*cos(q1) - 2*2^(1/2)*I3z*cos(q0)^4*cos(q1) + (20*2^(1/2)*a^2*m3*cos(q0)^2)/9 + (4*2^(1/2)*a^2*m3*cos(q0)^4)/9 + (20*2^(1/2)*a^2*m5*cos(q0)^2)/9 + (4*2^(1/2)*a^2*m5*cos(q0)^4)/9 - 28*2^(1/2)*b^2*m3*cos(q0)^2 - 4*2^(1/2)*b^2*m3*cos(q0)^4 - 28*2^(1/2)*b^2*m5*cos(q0)^2 - 4*2^(1/2)*b^2*m5*cos(q0)^4 + 4*I1x*cos(q0)*sin(q0)*sin(q1) - 4*I2x*cos(q0)*sin(q0)*sin(q1) - 4*I3x*cos(q0)*sin(q0)*sin(q1) - 4*I1y*cos(q0)*sin(q0)*sin(q1) + 4*I2y*cos(q0)*sin(q0)*sin(q1) + 4*I3y*cos(q0)*sin(q0)*sin(q1) + 4*I2yz*cos(q0)*sin(q0)*sin(q1) - 4*I1z*cos(q0)*sin(q0)*sin(q1) - 12*2^(1/2)*I1x*cos(q0)^2*cos(q1)^2 - 16*2^(1/2)*I1x*cos(q0)^2*cos(q1)^3 + 6*2^(1/2)*I1x*cos(q0)^4*cos(q1)^2 + 14*2^(1/2)*I1x*cos(q0)^4*cos(q1)^3 + 12*2^(1/2)*I1z*cos(q0)^2*cos(q1)^2 + 16*2^(1/2)*I1z*cos(q0)^2*cos(q1)^3 - 6*2^(1/2)*I1z*cos(q0)^4*cos(q1)^2 - 14*2^(1/2)*I1z*cos(q0)^4*cos(q1)^3 - (2*a*b*m2*sin(q1))/3 + (2*a*b*m3*sin(q1))/3 + (2*a*b*m5*sin(q1))/3 - (2*a*b*m6*sin(q1))/3 - 4*I1x*cos(q0)^3*sin(q0)*sin(q1) + 8*I2x*cos(q0)^3*sin(q0)*sin(q1) + 8*I3x*cos(q0)^3*sin(q0)*sin(q1) - 4*I1y*cos(q0)^3*sin(q0)*sin(q1) - 8*I2y*cos(q0)^3*sin(q0)*sin(q1) - 4*I3y*cos(q0)^3*sin(q0)*sin(q1) + 8*I1z*cos(q0)^3*sin(q0)*sin(q1) - 4*I3z*cos(q0)^3*sin(q0)*sin(q1) + (2^(1/2)*a^2*m2*cos(q1))/3 + (5*2^(1/2)*a^2*m3*cos(q1))/3 + (5*2^(1/2)*a^2*m5*cos(q1))/3 + (2^(1/2)*a^2*m6*cos(q1))/3 + 4*2^(1/2)*b^2*m2*cos(q1) + 4*2^(1/2)*b^2*m3*cos(q1) + 4*2^(1/2)*b^2*m5*cos(q1) + 4*2^(1/2)*b^2*m6*cos(q1) - 16*I1x*cos(q0)*cos(q1)*sin(q0)*sin(q1) + 16*I1z*cos(q0)*cos(q1)*sin(q0)*sin(q1) - (20*a^2*m3*cos(q0)*sin(q0)*sin(q1))/9 - (20*a^2*m5*cos(q0)*sin(q0)*sin(q1))/9 + 4*b^2*m3*cos(q0)*sin(q0)*sin(q1) + 4*b^2*m5*cos(q0)*sin(q0)*sin(q1) - (26*2^(1/2)*a*b*m3*sin(2*q0))/3 - (26*2^(1/2)*a*b*m5*sin(2*q0))/3 - 12*I1x*cos(q0)*cos(q1)^2*sin(q0)*sin(q1) + 8*I1x*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 12*I1z*cos(q0)*cos(q1)^2*sin(q0)*sin(q1) - 8*I1z*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + (8*a^2*m3*cos(q0)^3*sin(q0)*sin(q1))/9 + (8*a^2*m5*cos(q0)^3*sin(q0)*sin(q1))/9 - 8*b^2*m3*cos(q0)^3*sin(q0)*sin(q1) - 8*b^2*m5*cos(q0)^3*sin(q0)*sin(q1) - (32*a*b*m3*cos(q0)^2*sin(q1))/3 + (16*a*b*m3*cos(q0)^4*sin(q1))/3 - (32*a*b*m5*cos(q0)^2*sin(q1))/3 + (16*a*b*m5*cos(q0)^4*sin(q1))/3 + 20*I1x*cos(q0)^3*cos(q1)^2*sin(q0)*sin(q1) - 20*I1z*cos(q0)^3*cos(q1)^2*sin(q0)*sin(q1) - (16*2^(1/2)*a^2*m3*cos(q0)^2*cos(q1))/9 + (4*2^(1/2)*a^2*m3*cos(q0)^4*cos(q1))/9 - (16*2^(1/2)*a^2*m5*cos(q0)^2*cos(q1))/9 + (4*2^(1/2)*a^2*m5*cos(q0)^4*cos(q1))/9 + 12*2^(1/2)*b^2*m3*cos(q0)^2*cos(q1) - 4*2^(1/2)*b^2*m3*cos(q0)^4*cos(q1) + 12*2^(1/2)*b^2*m5*cos(q0)^2*cos(q1) - 4*2^(1/2)*b^2*m5*cos(q0)^4*cos(q1) - (8*2^(1/2)*a*b*m3*cos(q0)^3*sin(q0))/3 - (8*2^(1/2)*a*b*m5*cos(q0)^3*sin(q0))/3 + 8*2^(1/2)*a*b*m3*cos(q0)*cos(q1)*sin(q0) + 8*2^(1/2)*a*b*m5*cos(q0)*cos(q1)*sin(q0) - (8*2^(1/2)*a*b*m3*cos(q0)^3*cos(q1)*sin(q0))/3 - (8*2^(1/2)*a*b*m5*cos(q0)^3*cos(q1)*sin(q0))/3;
m21=8*2^(1/2)*I1x*cos(q0)^2 - 4*2^(1/2)*I1y - 2*2^(1/2)*I2y - 6*2^(1/2)*I3y - 4*2^(1/2)*I2yz - 6*2^(1/2)*I2z - 2*2^(1/2)*I3z - 6*2^(1/2)*I1x + 6*2^(1/2)*I1x*cos(q1)^2 - 4*2^(1/2)*I2x*cos(q0)^2 - 2*2^(1/2)*I1x*cos(q0)^4 + 2*2^(1/2)*I1x*cos(q1)^3 - 4*2^(1/2)*I3x*cos(q0)^2 + 4*2^(1/2)*I2x*cos(q0)^4 + 4*2^(1/2)*I3x*cos(q0)^4 - 6*2^(1/2)*I1y*cos(q0)^2 + 4*2^(1/2)*I2y*cos(q0)^2 - 2*2^(1/2)*I1y*cos(q0)^4 + 8*2^(1/2)*I3y*cos(q0)^2 - 4*2^(1/2)*I2y*cos(q0)^4 - 2*2^(1/2)*I3y*cos(q0)^4 + 12*2^(1/2)*I2yz*cos(q0)^2 - 4*2^(1/2)*I1z*cos(q0)^2 - 6*2^(1/2)*I1z*cos(q1)^2 + 4*2^(1/2)*I1z*cos(q0)^4 - 2*2^(1/2)*I1z*cos(q1)^3 - 4*2^(1/2)*I3z*cos(q0)^2 - 2*2^(1/2)*I3z*cos(q0)^4 - 2*2^(1/2)*I1x*cos(q1) + 2*2^(1/2)*I1y*cos(q1) - 2*2^(1/2)*I2y*cos(q1) + 2*2^(1/2)*I1z*cos(q1) + 2*2^(1/2)*I2z*cos(q1) - (2^(1/2)*a^2*m2)/9 - (7*2^(1/2)*a^2*m3)/3 - (7*2^(1/2)*a^2*m5)/3 - (2^(1/2)*a^2*m6)/9 - 2*2^(1/2)*b^2*m2 + 2*2^(1/2)*b^2*m3 + 2*2^(1/2)*b^2*m5 - 2*2^(1/2)*b^2*m6 + 12*2^(1/2)*I1x*cos(q0)^2*cos(q1) - 4*2^(1/2)*I2x*cos(q0)^2*cos(q1) - 10*2^(1/2)*I1x*cos(q0)^4*cos(q1) - 4*2^(1/2)*I3x*cos(q0)^2*cos(q1) + 4*2^(1/2)*I2x*cos(q0)^4*cos(q1) + 4*2^(1/2)*I3x*cos(q0)^4*cos(q1) + 4*2^(1/2)*I2y*cos(q0)^2*cos(q1) - 2*2^(1/2)*I1y*cos(q0)^4*cos(q1) + 2*2^(1/2)*I3y*cos(q0)^2*cos(q1) - 4*2^(1/2)*I2y*cos(q0)^4*cos(q1) - 2*2^(1/2)*I3y*cos(q0)^4*cos(q1) - 14*2^(1/2)*I1z*cos(q0)^2*cos(q1) + 12*2^(1/2)*I1z*cos(q0)^4*cos(q1) + 2*2^(1/2)*I3z*cos(q0)^2*cos(q1) - 2*2^(1/2)*I3z*cos(q0)^4*cos(q1) + (20*2^(1/2)*a^2*m3*cos(q0)^2)/9 + (4*2^(1/2)*a^2*m3*cos(q0)^4)/9 + (20*2^(1/2)*a^2*m5*cos(q0)^2)/9 + (4*2^(1/2)*a^2*m5*cos(q0)^4)/9 - 28*2^(1/2)*b^2*m3*cos(q0)^2 - 4*2^(1/2)*b^2*m3*cos(q0)^4 - 28*2^(1/2)*b^2*m5*cos(q0)^2 - 4*2^(1/2)*b^2*m5*cos(q0)^4 + 4*I1x*cos(q0)*sin(q0)*sin(q1) - 4*I2x*cos(q0)*sin(q0)*sin(q1) - 4*I3x*cos(q0)*sin(q0)*sin(q1) - 4*I1y*cos(q0)*sin(q0)*sin(q1) + 4*I2y*cos(q0)*sin(q0)*sin(q1) + 4*I3y*cos(q0)*sin(q0)*sin(q1) + 4*I2yz*cos(q0)*sin(q0)*sin(q1) - 4*I1z*cos(q0)*sin(q0)*sin(q1) - 12*2^(1/2)*I1x*cos(q0)^2*cos(q1)^2 - 16*2^(1/2)*I1x*cos(q0)^2*cos(q1)^3 + 6*2^(1/2)*I1x*cos(q0)^4*cos(q1)^2 + 14*2^(1/2)*I1x*cos(q0)^4*cos(q1)^3 + 12*2^(1/2)*I1z*cos(q0)^2*cos(q1)^2 + 16*2^(1/2)*I1z*cos(q0)^2*cos(q1)^3 - 6*2^(1/2)*I1z*cos(q0)^4*cos(q1)^2 - 14*2^(1/2)*I1z*cos(q0)^4*cos(q1)^3 - (2*a*b*m2*sin(q1))/3 + (2*a*b*m3*sin(q1))/3 + (2*a*b*m5*sin(q1))/3 - (2*a*b*m6*sin(q1))/3 - 4*I1x*cos(q0)^3*sin(q0)*sin(q1) + 8*I2x*cos(q0)^3*sin(q0)*sin(q1) + 8*I3x*cos(q0)^3*sin(q0)*sin(q1) - 4*I1y*cos(q0)^3*sin(q0)*sin(q1) - 8*I2y*cos(q0)^3*sin(q0)*sin(q1) - 4*I3y*cos(q0)^3*sin(q0)*sin(q1) + 8*I1z*cos(q0)^3*sin(q0)*sin(q1) - 4*I3z*cos(q0)^3*sin(q0)*sin(q1) + (2^(1/2)*a^2*m2*cos(q1))/3 + (5*2^(1/2)*a^2*m3*cos(q1))/3 + (5*2^(1/2)*a^2*m5*cos(q1))/3 + (2^(1/2)*a^2*m6*cos(q1))/3 + 4*2^(1/2)*b^2*m2*cos(q1) + 4*2^(1/2)*b^2*m3*cos(q1) + 4*2^(1/2)*b^2*m5*cos(q1) + 4*2^(1/2)*b^2*m6*cos(q1) - 16*I1x*cos(q0)*cos(q1)*sin(q0)*sin(q1) + 16*I1z*cos(q0)*cos(q1)*sin(q0)*sin(q1) - (20*a^2*m3*cos(q0)*sin(q0)*sin(q1))/9 - (20*a^2*m5*cos(q0)*sin(q0)*sin(q1))/9 + 4*b^2*m3*cos(q0)*sin(q0)*sin(q1) + 4*b^2*m5*cos(q0)*sin(q0)*sin(q1) - (26*2^(1/2)*a*b*m3*sin(2*q0))/3 - (26*2^(1/2)*a*b*m5*sin(2*q0))/3 - 12*I1x*cos(q0)*cos(q1)^2*sin(q0)*sin(q1) + 8*I1x*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 12*I1z*cos(q0)*cos(q1)^2*sin(q0)*sin(q1) - 8*I1z*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + (8*a^2*m3*cos(q0)^3*sin(q0)*sin(q1))/9 + (8*a^2*m5*cos(q0)^3*sin(q0)*sin(q1))/9 - 8*b^2*m3*cos(q0)^3*sin(q0)*sin(q1) - 8*b^2*m5*cos(q0)^3*sin(q0)*sin(q1) - (32*a*b*m3*cos(q0)^2*sin(q1))/3 + (16*a*b*m3*cos(q0)^4*sin(q1))/3 - (32*a*b*m5*cos(q0)^2*sin(q1))/3 + (16*a*b*m5*cos(q0)^4*sin(q1))/3 + 20*I1x*cos(q0)^3*cos(q1)^2*sin(q0)*sin(q1) - 20*I1z*cos(q0)^3*cos(q1)^2*sin(q0)*sin(q1) - (16*2^(1/2)*a^2*m3*cos(q0)^2*cos(q1))/9 + (4*2^(1/2)*a^2*m3*cos(q0)^4*cos(q1))/9 - (16*2^(1/2)*a^2*m5*cos(q0)^2*cos(q1))/9 + (4*2^(1/2)*a^2*m5*cos(q0)^4*cos(q1))/9 + 12*2^(1/2)*b^2*m3*cos(q0)^2*cos(q1) - 4*2^(1/2)*b^2*m3*cos(q0)^4*cos(q1) + 12*2^(1/2)*b^2*m5*cos(q0)^2*cos(q1) - 4*2^(1/2)*b^2*m5*cos(q0)^4*cos(q1) - (8*2^(1/2)*a*b*m3*cos(q0)^3*sin(q0))/3 - (8*2^(1/2)*a*b*m5*cos(q0)^3*sin(q0))/3 + 8*2^(1/2)*a*b*m3*cos(q0)*cos(q1)*sin(q0) + 8*2^(1/2)*a*b*m5*cos(q0)*cos(q1)*sin(q0) - (8*2^(1/2)*a*b*m3*cos(q0)^3*cos(q1)*sin(q0))/3 - (8*2^(1/2)*a*b*m5*cos(q0)^3*cos(q1)*sin(q0))/3;
m22=4*I1x + 4*I1y + 4*I2y + 4*I3y + 4*I2z + 4*I3z + (2*a^2*m2)/9 + 2*a^2*m3 + 2*a^2*m5 + (2*a^2*m6)/9 + 4*b^2*m2 + 4*b^2*m3 + 4*b^2*m5 + 4*b^2*m6 - 8*I1x*cos(q0)^2 - 4*I1x*cos(q1)^2 + 8*I2x*cos(q0)^2 + 4*I1x*cos(q0)^4 + 8*I3x*cos(q0)^2 - 8*I2x*cos(q0)^4 - 8*I3x*cos(q0)^4 + 8*I1y*cos(q0)^2 - 8*I2y*cos(q0)^2 + 4*I1y*cos(q0)^4 - 8*I3y*cos(q0)^2 + 8*I2y*cos(q0)^4 + 4*I3y*cos(q0)^4 - 8*I2yz*cos(q0)^2 + 8*I1z*cos(q0)^2 + 4*I1z*cos(q1)^2 - 8*I1z*cos(q0)^4 + 4*I3z*cos(q0)^4 + 16*I1x*cos(q0)^2*cos(q1)^2 - 12*I1x*cos(q0)^4*cos(q1)^2 - 16*I1z*cos(q0)^2*cos(q1)^2 + 12*I1z*cos(q0)^4*cos(q1)^2 - (8*a^2*m3*cos(q0)^2)/9 - (8*a^2*m3*cos(q0)^4)/9 - (8*a^2*m5*cos(q0)^2)/9 - (8*a^2*m5*cos(q0)^4)/9 + 24*b^2*m3*cos(q0)^2 + 8*b^2*m3*cos(q0)^4 + 24*b^2*m5*cos(q0)^2 + 8*b^2*m5*cos(q0)^4 + (20*a*b*m3*sin(2*q0))/3 + (20*a*b*m5*sin(2*q0))/3 + (16*a*b*m3*cos(q0)^3*sin(q0))/3 + (16*a*b*m5*cos(q0)^3*sin(q0))/3 + 8*2^(1/2)*I1x*cos(q0)*cos(q1)*sin(q0)*sin(q1) - 8*2^(1/2)*I1z*cos(q0)*cos(q1)*sin(q0)*sin(q1) - 8*2^(1/2)*I1x*cos(q0)^3*cos(q1)*sin(q0)*sin(q1) + 8*2^(1/2)*I1z*cos(q0)^3*cos(q1)*sin(q0)*sin(q1);
 
M=[ m11 m12;
    m21 m22];