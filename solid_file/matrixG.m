function G=matrixG(q)
%q=[pi/3; 1.7722];
global m1 m2 m3 m4 m5 m6 mt J1 J2 J3 JB g a b d I1x I1y I1z I2x I2y I2z I2yz I3x I3y I3z
q0=q(1); q1=q(2);
G=[ 4*g*m2*((a*cos(q0))/2 + 2*b*sin(q0) - (a*cos(q0)*cos(q1))/6 - b*cos(q1)*sin(q0) + (2^(1/2)*b*cos(q0)*sin(q1))/2 - (2^(1/2)*a*sin(q0)*sin(q1))/6) + 4*g*m6*((a*cos(q0))/2 + 2*b*sin(q0) - (a*cos(q0)*cos(q1))/6 - b*cos(q1)*sin(q0) + (2^(1/2)*b*cos(q0)*sin(q1))/2 - (2^(1/2)*a*sin(q0)*sin(q1))/6) + 4*g*m3*((3*a*cos(q0))/2 + b*sin(q0) - a*cos(q0)^3 - (5*a*cos(q0)*cos(q1))/2 + 3*a*cos(q0)^3*cos(q1) + 3*b*cos(q0)^2*sin(q0) + 6*2^(1/2)*b*cos(q0)^3*sin(q1) - 9*b*cos(q0)^2*cos(q1)*sin(q0) - (7*2^(1/2)*b*cos(q0)*sin(q1))/2 - (5*2^(1/2)*a*sin(q0)*sin(q1))/6 + 2*2^(1/2)*a*cos(q0)^2*sin(q0)*sin(q1)) + 4*g*m5*((3*a*cos(q0))/2 + b*sin(q0) - a*cos(q0)^3 - (5*a*cos(q0)*cos(q1))/2 + 3*a*cos(q0)^3*cos(q1) + 3*b*cos(q0)^2*sin(q0) + 6*2^(1/2)*b*cos(q0)^3*sin(q1) - 9*b*cos(q0)^2*cos(q1)*sin(q0) - (7*2^(1/2)*b*cos(q0)*sin(q1))/2 - (5*2^(1/2)*a*sin(q0)*sin(q1))/6 + 2*2^(1/2)*a*cos(q0)^2*sin(q0)*sin(q1)) + 4*g*m1*((a*cos(q0))/2 + 3*b*sin(q0)) + 4*g*m4*((3*a*cos(q0))/2 - 3*b*sin(q0)) + g*mt*(2*a*cos(q0) - 4*b*sin(q0));
                                                                                                                                                                                                                                                                                                                            4*g*m2*((a*sin(q0)*sin(q1))/6 - b*cos(q0)*sin(q1) + (2^(1/2)*a*cos(q0)*cos(q1))/6 + (2^(1/2)*b*cos(q1)*sin(q0))/2) + 4*g*m6*((a*sin(q0)*sin(q1))/6 - b*cos(q0)*sin(q1) + (2^(1/2)*a*cos(q0)*cos(q1))/6 + (2^(1/2)*b*cos(q1)*sin(q0))/2) + 4*g*m3*((a*sin(q0)*sin(q1))/2 - 3*b*cos(q0)^3*sin(q1) - (2*2^(1/2)*a*cos(q0)^3*cos(q1))/3 - a*cos(q0)^2*sin(q0)*sin(q1) + (5*2^(1/2)*a*cos(q0)*cos(q1))/6 + (2^(1/2)*b*cos(q1)*sin(q0))/2 + 2*2^(1/2)*b*cos(q0)^2*cos(q1)*sin(q0)) + 4*g*m5*((a*sin(q0)*sin(q1))/2 - 3*b*cos(q0)^3*sin(q1) - (2*2^(1/2)*a*cos(q0)^3*cos(q1))/3 - a*cos(q0)^2*sin(q0)*sin(q1) + (5*2^(1/2)*a*cos(q0)*cos(q1))/6 + (2^(1/2)*b*cos(q1)*sin(q0))/2 + 2*2^(1/2)*b*cos(q0)^2*cos(q1)*sin(q0))];
 